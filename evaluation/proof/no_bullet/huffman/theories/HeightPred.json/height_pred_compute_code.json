[{"history": {"proof": "", "repairs": [], "exceptions": [{"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl."], "tactic": "pose proof (frequency_length A eqA_dec (map (fun x : A * list bool => fst x) (compute_code t)) (encode eqA_dec (compute_code t) (all_leaves t))).", "exn": "The reference t was not found in the current environment.", "type": "ref_not_found", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl."], "tactic": "unfold encode in H.", "exn": "No such hypothesis: H", "type": "no_hypos", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode."], "tactic": "rewrite <- H.", "exn": "The reference H was not found in the current environment.", "type": "ref_not_found", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq."], "tactic": "clear H.", "exn": "No such hypothesis: H", "type": "no_hypos", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode."], "tactic": "apply cover_node with (node t1 t2) (all_leaves t).", "exn": "The reference t was not found in the current environment.", "type": "ref_not_found", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code."], "tactic": "rewrite map_map.", "exn": "Found no subterm matching \"map ?M3008 (map ?M3007 ?M3009)\" in the current goal.", "type": "no_subterm", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map."], "tactic": "rewrite map_ext with (g := fst).", "exn": "Found no subterm matching \"map ?M3922 ?M3925\" in the current goal.", "type": "no_subterm", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map."], "tactic": "rewrite ulist_ordered_cover with (l2 := all_leaves t1).", "exn": "Found no subterm matching \"all_leaves ?M5088\" in the current goal.", "type": "no_subterm", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map."], "tactic": "apply permutation_map.", "exn": "In environment H3 : forall (A B C : Type) (f : A -> B) (g : B -> C) (l : list A), map g (map f l) = map (fun x : A => g (f x)) l H2 : forall (A B : Type) (f g : A -> B), (forall a : A, f a = g a) -> forall l : list A, map f l = map g l X6 : forall A : Type, btree A -> list A X3, X1, X0, X : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool A : Type f : A -> nat eqA_dec : forall a b : A, {a = b} + {a = b -> False} n : nat t1, t2 : btree A IHt1 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t1)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t1)) t1 IHt2 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t2)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t2)) t2 X2 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H : forall (A : Type) (l1 : list (btree A)) (l2 : list A) (t : btree A), ordered_cover l1 t -> ulist l2 -> l1 = map (fun x : A => leaf x) l2 -> all_leaves t = l2 X4 : A -> A -> A Unable to unify \"permutation (map ?M6478 ?M6479) (map ?M6478 ?M6480)\" with \"height_pred n (map (fun x : A * list bool => length (snd x) + n) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) (map (fun x : A * list bool => leaf (fst x)) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) ?Goal13\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map."], "tactic": "apply H0.", "exn": "The reference H0 was not found in the current environment.", "type": "ref_not_found", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map."], "tactic": "apply frequency_length.", "exn": "In environment H5 : forall (A B C : Type) (f : A -> B) (g : B -> C) (l : list A), map g (map f l) = map (fun x : A => g (f x)) l H4 : forall (A B : Type) (f g : A -> B), (forall a : A, f a = g a) -> forall l : list A, map f l = map g l X8, X6 : forall A : Type, btree A -> list A X3, X1, X0, X : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool A : Type f : A -> nat eqA_dec : forall a b : A, {a = b} + {a = b -> False} n : nat t1, t2 : btree A IHt1 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t1)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t1)) t1 IHt2 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t2)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t2)) t2 X2 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H : forall (A : Type) (l1 : list (btree A)) (l2 : list A) (t : btree A), ordered_cover l1 t -> ulist l2 -> l1 = map (fun x : A => leaf x) l2 -> all_leaves t = l2 X5 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H1 : forall (A B : Type) (f : A -> B) (l1 l2 : list A), permutation l1 l2 -> permutation (map f l1) (map f l2) X4 : A -> A -> A Unable to unify \"length (encode ?M8112 ?M8114 ?M8113) = fold_left (fun (a : nat) (b : ?M8111 * list bool) => a + number_of_occurrences ?M8112 (fst b) ?M8113 * length (snd b)) ?M8114 0\" with \"height_pred n (map (fun x : A * list bool => length (snd x) + n) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) (map (fun x : A * list bool => leaf (fst x)) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) ?Goal13\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: frequency_length,ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map."], "tactic": "apply H.", "exn": "In environment H7 : forall (A B C : Type) (f : A -> B) (g : B -> C) (l : list A), map g (map f l) = map (fun x : A => g (f x)) l H6 : forall (A B : Type) (f g : A -> B), (forall a : A, f a = g a) -> forall l : list A, map f l = map g l X10, X8, X6 : forall A : Type, btree A -> list A X3, X1, X0, X : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool A : Type f : A -> nat eqA_dec : forall a b : A, {a = b} + {a = b -> False} n : nat t1, t2 : btree A IHt1 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t1)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t1)) t1 IHt2 : height_pred n (map (fun x : A * list bool => length (snd x) + n) (compute_code t2)) (map (fun x : A * list bool => leaf (fst x)) (compute_code t2)) t2 X2 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H : forall (A : Type) (l1 : list (btree A)) (l2 : list A) (t : btree A), ordered_cover l1 t -> ulist l2 -> l1 = map (fun x : A => leaf x) l2 -> all_leaves t = l2 X5 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H1 : forall (A B : Type) (f : A -> B) (l1 l2 : list A), permutation l1 l2 -> permutation (map f l1) (map f l2) X7 : forall A : Type, (forall a b : A, {a = b} + {a = b -> False}) -> code A -> list A -> list bool H0 : forall (A : Type) (eqA_dec : forall a b : A, {a = b} + {a = b -> False}) (m : list A) (c : code A), unique_key c -> length (encode eqA_dec c m) = fold_left (fun (a : nat) (b : A * list bool) => a + number_of_occurrences eqA_dec (fst b) m * length (snd b)) c 0 X4 : A -> A -> A Unable to unify \"all_leaves ?M9973 = ?M9972\" with \"height_pred n (map (fun x : A * list bool => length (snd x) + n) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) (map (fun x : A * list bool => leaf (fst x)) (map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) ((fix compute_code (a : btree A) : list (A * list bool) := match a with | leaf b => [(b, [])] | node l1 l2 => map (fun v : A * list bool => let (a1, b1) := v in (a1, false :: b1)) (compute_code l1) ++ map (fun v : A * list bool => let (a1, b1) := v in (a1, true :: b1)) (compute_code l2) end) t2))) ?Goal13\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: frequency_length,ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: frequency_length,ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map."], "tactic": "apply ulist_elements.", "exn": "The reference ulist_elements was not found in the current environment.", "type": "ref_not_found", "handled": true}, {"ctx": ["intros n t.", "induction t using btree_ind.", "-", "simpl.", "constructor.", "-", "simpl.", "qsimpl time: 1 use: encode.", "rewrite <- morph_eq.", "qsimpl time: 1 use: encode.", "+", "unfold compute_code.", "qsimpl time: 1 use: encode,map_map.", "qsimpl time: 1 use: fst,map_ext,encode,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: frequency_length,ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map.", "qsimpl time: 1 use: frequency_length,ulist_ordered_cover,permutation_map,encode,fst,all_leaves,map_ext,map_map."], "tactic": "intros [].", "exn": "No product even after head-reduction.", "type": "no_product", "handled": true}]}, "chat": [], "original": "intros n t. induction t using btree_ind. - simpl. constructor. - simpl. pose proof (frequency_length A eqA_dec (map (fun x : A * list bool => fst x) (compute_code t)) (encode eqA_dec (compute_code t) (all_leaves t))). unfold encode in H. rewrite <- H. clear H. apply cover_node with (node t1 t2) (all_leaves t). + unfold compute_code. rewrite map_map. simpl. rewrite map_ext with (g := fst). * rewrite ulist_ordered_cover with (l2 := all_leaves t1). ++ apply permutation_map. apply H0. ++ apply frequency_length. apply H. ++ apply ulist_elements. * intros []. simpl. reflexivity. + apply IHt1. apply H0. + apply IHt2. apply H1.", "succ": false}]