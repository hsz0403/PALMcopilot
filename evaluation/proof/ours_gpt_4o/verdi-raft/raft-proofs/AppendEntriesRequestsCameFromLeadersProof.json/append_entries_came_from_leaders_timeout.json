[{"history": {"proof": "", "repairs": [], "exceptions": [{"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-"], "tactic": "apply refined_raft_net_invariant_init.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term Unable to unify \"Prop\" with \"refined_raft_net_invariant_init (fun _ : network => forall (n : name) (pli : logIndex) (plt : term) (es : list entry) (ci : logIndex), In H2 (nwPackets {| nwPackets := ps'; nwState := st' |}) -> pBody H2 = AppendEntries H3 n pli plt es ci -> exists ll : list entry, In (H3, ll) (leaderLogs (fst (nwState {| nwPackets := ps'; nwState := st' |} (pSrc H2)))))\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init."], "tactic": "-", "exn": "Wrong bullet -: Current bullet - is not finished.", "type": "unfinished_bullet", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-"], "tactic": "apply refined_raft_net_invariant_client_request'_weak.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term h0 : name net0 : network st'0 : Net.name -> data ps'0 : list packet gd0 : electionsData out0 : list raft_output d0 : raft_data l0 : list (name * msg) client0 : clientId id0 : nat c0 : input e : handleClientRequest h0 (snd (nwState net0 h0)) client0 id0 c0 = (out0, d0, l0) e0 : gd0 = update_elections_data_client_request h0 (nwState net0 h0) client0 id0 c0 y : ?M3627 net0 r : refined_raft_intermediate_reachable net0 Unable to unify \"refined_raft_intermediate_reachable {| nwPackets := ps'0; nwState := st'0 |}\" with \"forall h' : name, st'0 h' = update name_eq_dec (nwState net0) h0 (gd0, d0) h'\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init."], "tactic": "+", "exn": "Wrong bullet +: Expecting -.", "type": "wrong_bullet", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-"], "tactic": "apply append_entries_came_from_leaders_invariant.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term Unable to unify \"packet\" with \"network\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--"], "tactic": "apply refined_raft_net_invariant.", "exn": "Unable to find an instance for the variable net.", "type": "no_instance_var", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++"], "tactic": "apply refined_raft_net_invariant_init.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params P : (network -> Prop) -> Prop H6 : forall net : network -> Prop, refined_raft_net_invariant_client_request net -> refined_raft_net_invariant_client_request' net lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> electionsData * raft_data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (map (fun m : name * msg => {| pSrc := net; pDst := fst m; pBody := snd m |}) l) H2 : packet H3 : term H5 : forall net : network, refined_raft_intermediate_reachable net -> append_entries_came_from_leaders net H4 : forall (P : network -> Prop) (net : network), refined_raft_net_invariant_init P -> refined_raft_net_invariant_client_request P -> refined_raft_net_invariant_timeout P -> refined_raft_net_invariant_append_entries P -> refined_raft_net_invariant_append_entries_reply P -> refined_raft_net_invariant_request_vote P -> refined_raft_net_invariant_request_vote_reply P -> refined_raft_net_invariant_do_leader P -> refined_raft_net_invariant_do_generic_server P -> refined_raft_net_invariant_state_same_packet_subset P -> refined_raft_net_invariant_reboot P -> refined_raft_intermediate_reachable net -> P net Unable to unify \"Prop\" with \"P (fun _ : network => append_entries_came_from_leaders_interface)\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init."], "tactic": "++", "exn": "Wrong bullet ++: Current bullet ++ is not finished.", "type": "unfinished_bullet", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "shelve.", "++"], "tactic": "apply refined_raft_net_invariant_client_request'_weak.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term Unable to unify \"forall (h0 : name) (net0 : network) (st'0 : Net.name -> data) (ps'0 : list packet) (gd0 : electionsData) (out0 : list raft_output) (d0 : raft_data) (l0 : list (name * msg)) (client0 : clientId) (id0 : nat) (c0 : input), handleClientRequest h0 (snd (nwState net0 h0)) client0 id0 c0 = (out0, d0, l0) -> gd0 = update_elections_data_client_request h0 (nwState net0 h0) client0 id0 c0 -> ?M8966 net0 -> refined_raft_intermediate_reachable net0 -> refined_raft_intermediate_reachable {| nwPackets := ps'0; nwState := st'0 |} -> (forall h' : Net.name, st'0 h' = update name_eq_dec (nwState net0) h0 (gd0, d0) h') -> (forall p' : packet, In p' ps'0 -> In p' (nwPackets net0) \\\\/ In p' (send_packets h0 l0)) -> ?M8966 {| nwPackets := ps'0; nwState := st'0 |}\" with \"append_entries_came_from_leaders_interface\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "shelve.", "++"], "tactic": "apply leaders_have_leaderLogs_invariant.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term Unable to unify \"forall h0 : Net.name, type (snd (nwState ?M8966 h0)) = Leader -> exists ll : list entry, In (currentTerm (snd (nwState ?M8966 h0)), ll) (leaderLogs (fst (nwState ?M8966 h0)))\" with \"append_entries_came_from_leaders_interface\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "shelve.", "++"], "tactic": "eapply lhlli.", "exn": "In environment orig_base_params : BaseParams one_node_params : OneNodeParams orig_base_params raft_params : RaftParams orig_base_params lhlli : leaders_have_leaderLogs_interface rri : raft_refinement_interface h : network net : name st' : name -> data ps' : list packet gd : electionsData out : list raft_output d : raft_data l : list (name * msg) client : handleTimeout net (snd (nwState h net)) = (out, d, l) id : gd = update_elections_data_timeout net (nwState h net) c : append_entries_came_from_leaders h H : refined_raft_intermediate_reachable h H0 : forall h' : name, st' h' = update name_eq_dec (nwState h) net (gd, d) h' H1 : forall p' : packet, In p' ps' -> In p' (nwPackets h) \\\\/ In p' (send_packets net l) H2 : packet H3 : term Unable to unify \"leaders_have_leaderLogs_interface\" with \"append_entries_came_from_leaders_interface\".", "type": "cannot_unify", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "shelve.", "++"], "tactic": "-", "exn": "Wrong bullet -: Current bullet ++ is not finished.", "type": "unfinished_bullet", "handled": true}, {"ctx": ["intros h net st' ps' gd out d l client id c.", "intros H H0 H1 H2 H3.", "eapply refined_raft_net_invariant.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_init.", "shelve.", "-", "qsimpl time: 1 use: refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "-", "qsimpl time: 1 use: append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "eapply rri.", "--", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "++", "qsimpl time: 1 use: refined_raft_net_invariant,append_entries_came_from_leaders_invariant,refined_raft_net_invariant_client_request'_weak,refined_raft_net_invariant_init.", "shelve.", "++", "shelve."], "tactic": "-", "exn": "Wrong bullet -: Expecting --.", "type": "wrong_bullet", "handled": true}]}, "chat": [], "original": "intros h net st' ps' gd out d l client id c. intros H H0 H1 H2 H3. eapply refined_raft_net_invariant. - apply refined_raft_net_invariant_init. - apply refined_raft_net_invariant_client_request'_weak. + apply append_entries_came_from_leaders_invariant. * eapply rri. -- apply refined_raft_net_invariant. ++ apply refined_raft_net_invariant_init. ++ apply refined_raft_net_invariant_client_request'_weak. ** apply leaders_have_leaderLogs_invariant. --- eapply lhlli. - eauto.", "back_times": 20, "succ": false, "time": 458.1277542114258}]